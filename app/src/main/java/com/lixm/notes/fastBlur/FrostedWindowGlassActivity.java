package com.lixm.notes.fastBlur;import android.app.Dialog;import android.content.DialogInterface;import android.graphics.Bitmap;import android.graphics.drawable.BitmapDrawable;import android.os.Bundle;import android.view.View;import android.view.Window;import androidx.annotation.Nullable;import androidx.appcompat.app.AppCompatActivity;import com.lixm.notes.R;public class FrostedWindowGlassActivity extends AppCompatActivity {    @Override    protected void onCreate(@Nullable Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        setContentView(R.layout.activity_frosted_window);    }    public void showDialog(View view) {        final Dialog dialog = new Dialog(FrostedWindowGlassActivity.this, R.style.SquareEntranceDialogStyle);        Window window = dialog.getWindow();        Bitmap blurBg = null;        if (window != null) {            long startMs = System.currentTimeMillis();            // 获取截图            View activityView = getWindow().getDecorView();            activityView.setDrawingCacheEnabled(true);            activityView.destroyDrawingCache();            activityView.buildDrawingCache();            Bitmap bmp = activityView.getDrawingCache();            // 模糊处理并保存            blurBg = BlurBitmap.blur(FrostedWindowGlassActivity.this, bmp);            // 设置成dialog的背景            window.setBackgroundDrawable(new BitmapDrawable(getResources(), blurBg));            bmp.recycle();        }        final Bitmap finalBlurBg = blurBg;        dialog.setOnDismissListener(new DialogInterface.OnDismissListener() {            @Override            public void onDismiss(DialogInterface dialog) {                // 对话框取消时释放背景图bitmap                if (finalBlurBg != null && !finalBlurBg.isRecycled()) {                    finalBlurBg.recycle();                }            }        });        View layout = View.inflate(FrostedWindowGlassActivity.this, R.layout.square_posting_entrance_dialog, null);        dialog.setContentView(layout);        dialog.show();    }}